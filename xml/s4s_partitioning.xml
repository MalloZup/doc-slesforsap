<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="sec.s4s.partition">
 <title>Partitioning</title>

 <para>
  &sles4sap; creates the partitioning table in two stages:
 </para>
 <orderedlist>
  <listitem>
   <para>
    <xref linkend="sec.s4s.partition.os"/> (during the installation of the
    operating system)
   </para>
  </listitem>
  <listitem>
   <para>
    <xref linkend="sec.s4s.partition.sap"/> (during the installation of the
    SAP product)
   </para>
  </listitem>
 </orderedlist>

 <sect2 xml:id="sec.s4s.partition.os">
  <title>Partitioning for the Operating System (stage 1)</title>

  <para>
   During the installation of the operating system, partitions for the
   operating system are created.
  </para>

  <para>
   A logical volume group (LVG) named <literal>system</literal> will be
   created. This LVG contains two logical volumes (LVs):
  </para>

  <itemizedlist>
   <listitem>
    <para>
     <filename>/dev/system/root</filename> (by default: 60 GB, do not set
     smaller than 5 GB)
     <remark>5GB min is from old guide. Still good? - sknorr, 2016-01-21</remark>
    </para>
   </listitem>
   <listitem>
    <para>
     <filename>/dev/system/swap</filename> (by default: 2 GB, avoid setting a
     smaller size)
    </para>
   </listitem>
  </itemizedlist>
  <para>
   Additionally, a <filename>boot</filename> or UEFI partition will be created
   as necessary.
   The partitions are created according to
   <citetitle>SAP Note 1984787</citetitle>
   (<link xlink:href="https://service.sap.com/sap/support/notes/1984787"/>).
   <remark>SAP Note is for SLES 12! FIXME - sknorr, 2016-01-21</remark>
  </para>

 </sect2>

 <sect2 xml:id="sec.s4s.partition.sap">
  <title>Partitioning for the SAP System (stage 2)</title>

  <para>
   <remark>
    SAP system or SAP product? (System could be multiple products.)
    What's better? - sknorr, 2016-01-21
   </remark>
   The partitioning for the SAP system is done by the &sapwiz;
   and can only take place after the operating system has been installed.
   That means the partitions are created either during the installation workflow
   after the reboot or in the running system.
  </para>

  <remark>
   According to varkoly, Netweaver stuff generally needs 80GB (or more) to
   itself, HANA needs 60GB to itself. Should I put this here or is this info
   too info...rmal? - sknorr, 2016-01-21
  </remark>

  <para>
   The partitioning for the SAP system is not controlled by
   <filename>autoinst.xml</filename> which is only used for the installation of
   the operating system. The <filename>autoinst.xml</filename> functionality no
   longer exists in the running system. Instead, the following files
   control the partitioning for the SAP system:
  </para>

  <para>
   In <filename>/etc/sap-installation-wizard.xml</filename>, the
   <literal>&lt;partitioning&gt;</literal> tag defines for which SAP
   programs which files for controlling the partitioning are used. These
   files will be taken from
   <filename>/usr/share/YaST2/include/sap-installation-wizard/</filename>.
   If no partitioning is needed (for example, if the installation is based
   on HA or a distributed database is configured), set the
   <literal>&lt;partitioning&gt;</literal> tag to <literal>no</literal>,
   then <filename>base_partitioning.xml</filename> will be used.
  </para>

  <para>
   The files for controlling the partitioning are &ay; control
   files that contain a partitioning section only. There are several
   extensions:
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     If the <literal>&lt;partitioning_defined&gt;</literal> tag is set to
     <literal>true</literal>, the partitioning will be performed without any
     user interaction. This, for example, is preconfigured in files for
     controlling the partitioning of known hardware such as Dell, Fujitsu,
     HP, or IBM Server systems. If the &sapwiz; recognizes
     this hardware, the appropriate file will be selected.
<!--Note-->
     This applies for SAP Business One/HANA only!
    </para>
   </listitem>
   <listitem>
    <para>
     For every partition, you can specify the
     <literal>&lt;size_min&gt;</literal> tag. The size value can be given as
     a string in the format of
     <literal><replaceable>RAM</replaceable>*<replaceable>N</replaceable></literal>.
     This way you can specify how large the partition should be minimally
     (<replaceable>N</replaceable> times the size of the available
     memory (<replaceable>RAM</replaceable>)).
    </para>
   </listitem>
  </itemizedlist>

  <para>
   If you need something different (for example, for TREX), proceed as follows:
  </para>

  <procedure>
   <step>
    <para>
     In
     <filename>/usr/share/YaST2/include/sap-installation-wizard/</filename>,
     create a new file for controlling the partitioning (for example,
     <filename>TREX_partitioning.xml</filename>). You can base the new file
     on <filename>base_partitioning.xml</filename> and change it according
     to your needs.
    </para>
   </step>
   <step>
    <para>
     In <filename>/etc/sap-installation-wizard.xml</filename>, at the
     <literal>TREX</literal> following tag insert:
    </para>
<screen><![CDATA[<partitioning>TREX_partitioning.xml</partitioning>]]></screen>
   </step>
  </procedure>

  <important>
   <title>Do Not Edit <filename>base_partitioning.xml</filename></title>
   <para>
    Do not edit <filename>base_partitioning.xml</filename> directly. With
    the next update, this file will be overridden.
   </para>
  </important>

  <para>
   For more information on partitioning with &ay;, see the
   <emphasis>ChapterÂ 4.4 <quote>Partitioning</quote></emphasis> of the
   <emphasis>&ay; Guide</emphasis>.
  </para>
 </sect2>
</sect1>
