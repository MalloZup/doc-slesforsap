<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="cha.s4s.install">
 <title>Installing the Operating System</title>

 <para>
  The following section provides instructions on how to install the
  base operating system, &sls; either using the installation workflow,
  over the network or using &ay;.
 </para>

 <sect1 xml:id="sec.s4s.install.workflow">
  <title>Using the Installation Workflow</title>

  <para>
   The installation workflow is a guided installation of the operating system
   with optimized
   settings for SAP applications. During the installation workflow, you can
   choose whether you want to install an SAP application. If so, you will be
   asked to provide SAP installation media when the &sls; installation is
   finished. You can also choose whether to install third-party extensions.
  </para>
  <para>
   For more information, see <xref linkend="sec.s4s.workflow-overview"/>.
  </para>

  <para>
   This section will guide you through the installation of the &sles4sap;
   operating system.
  </para>

  <procedure xml:id="pro.s4s.workflow.start">
   <title>Starting the OS Installation</title>
   <step>
    <para>
     Boot from the DVD.
     From the DVD boot menu, select <guimenu>Installation</guimenu>.
     <!-- Too basic? -->
     <!-- To navigate to the entry, use the keys <keycap function="up"/> and
     <keycap function="down"/>.
     To choose the entry, press <keycap function="enter"/>. -->
    </para>

    <figure xml:id="fig.s4s.dvd.bootmenu">
     <title>DVD Boot Menu</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="s4s-dvd-boot-menu.png" width="73%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="s4s-dvd-boot-menu.png" width="73%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>

    <para>
     While the initial operating system is starting, you can view boot messages
     by pressing <keycap function="escape"/>.
     When this process has completed, the graphical installation workflow
     will start.
    </para>
   </step>

   <!-- FIXME: This information may be helpful, but here is the wrong place for
        it. We want a straightforward procedure. -->
   <!-- <variablelist>
    <varlistentry>
     <term>Boot from Hard Disk</term>
     <listitem>
      <para>
       Boot the system that is already installed on the local hard disk.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Installation</guimenu> (see <xref linkend="s4s.inst.inst"/>)</term>
     <listitem>
      <para>
       Start a &slsa; installation workflow which allows you to choose whether to
       prepare for installing SAP applications later or installing an
       SAP application directly after the OS installation.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Upgrade</term>
     <listitem>
      <para>
       Upgrade the system. For more information, see
       <citetitle>&deploy;, Chapter 17,
        <quote>Upgrading SUSE Linux Enterprise</quote>
       </citetitle>
       (&docaddress;).
       <remark>Better use Chapter 18, Service Pack Migration? or reference the
        entire part? Part III, Updating and Upgrading SUSE Linux Enterprise?
       </remark>
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Rescue System</term>
     <listitem>
      <para>
       Start a minimal Linux system without a graphical user interface.
       For more information, see
       <citetitle>&admin;, Chapter 37,
        <quote>Common Problems and Their Solutions</quote>
       </citetitle>
       (&docaddress;).
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Check Installation Media</term>
     <listitem>
      <para>
       Check the data integrity of the installation media.
       For more information, see
       <citetitle>&admin;, Chapter 37,
        <quote>Common Problems and Their Solutions</quote>
       </citetitle>
       (&docaddress;).
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Memory Test</term>
     <listitem>
      <para>
       Test the system RAM using repeated read and write cycles.
       <remark>Citetitle wanted... - sknorr, 2015-01-07</remark>
      </para>
     </listitem>
    </varlistentry>
   </variablelist> -->

   <step>
    <para>
     Select the default system language under <guimenu>Language</guimenu>.
    </para>
    <figure xml:id="fig.s4s.install.license">
     <title>Language, Keyboard and License Agreement</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="s4s-install-license.png" width="73%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="s4s-install-license.png" width="73%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </step>
   <step>
    <para>
     Select a fitting keyboard layout <guimenu>Keyboard Layout</guimenu>.
     To test whether the selected layout matches your physical keyboard,
     use the text box <guimenu>Keyboard Test</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Read the license agreement. If you agree, select
     <guimenu>I Agree to the License Terms</guimenu>.
     Proceed with <guimenu>Next</guimenu>.
    </para>
    <para>
     Otherwise, cancel the installation with
     <menuchoice><guimenu>Abort</guimenu>
     <guimenu>Abort Installation</guimenu></menuchoice>.
    </para>
   </step>
   <step performance="optional">
    <para>
     If automatic network configuration via DHCP fails, the screen
     <guimenu>Network Settings</guimenu> will open automatically.
    </para>
    <para>
     If instead the screen <guimenu>Registration</guimenu> appears,
     your network connection works. To change network settings anyway, click
     <guimenu>Network Configuration</guimenu>.
    </para>
    <para>
     When you are finished configuring networking, proceed with
     <guimenu>Next</guimenu>.
    </para>
    <important>
     <title>Configure Networking as Recommended by SAP</title>
     <para>
      Make sure to configure the network connection as recommended in the
      documentation provided to you by SAP.
     </para>
    </important>
    <para>
     For details regarding network configuration, see
     <citetitle>
      &admin;, Chapter 19 <quote>Basic Networking</quote>,
      Section 19.4 <quote>Configuring a Network Connection with YaST</quote>
     </citetitle> (&docaddress;).
    </para>
   </step>
   <step>
    <para>
     On the screen <guimenu>Registration</guimenu>, enter your
     <guimenu>E-Mail Address</guimenu> and <guimenu>Registration Code</guimenu>.
     Successful registration is a prerequisite for receiving product updates and
     being entitled to technical support.
    </para>
    <para>
     Proceed with <guimenu>Next</guimenu>.
    </para>
    <important>
     <title>Register at This Step</title>
     <para>
      Make sure to register your system at this step in the installation.
      Otherwise, you will not receive vital package updates immediately.
     </para>
     <para>
      Additionally, your system will also not be set up to receive packages
      from the &sleha; repository.
      This is important if you want to install a highly available SAP product.
     </para>
    </important>
    <figure xml:id="fig.s4s.install.reg-dialog">
     <title>Registration</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="s4s-install-registration.png" width="73%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="s4s-install-registration.png" width="73%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <note>
     <title>Release Notes</title>
     <para>
      From this point on, the Release Notes can be viewed from any screen during
      the installation process by selecting <guimenu>Release Notes</guimenu>.
     </para>
    </note>
   </step>
   <step>
    <para>
     When asked whether to enable update repositories, choose
     <guimenu>Yes</guimenu>.
    </para>
   </step>
   <step>
    <para>
     On the screen, <guimenu>Extension and Module Selection</guimenu>, you
     can optionally choose additional &slea; extensions and modules.
     The list contains free modules, such as the &sle; SDK and extensions
     requiring a registration key that is liable for costs.
     Proceed with <guimenu>Next</guimenu>.
    </para>
   </step>
   <step>
    <para>
     The following screen allows you to choose the
     <guimenu>Product Installation Mode</guimenu>.
     You can now choose between:
    </para>
    <itemizedlist>
     <listitem>
      <formalpara>
       <title>A &sls; installation</title>
       <para>
        To install a &slsa; system without SAP-specific customizations,
        choose <guimenu>Proceed with standard SLES installation</guimenu>.
        For details, see
        <citetitle>
         &instquick;, Section 1.2 <quote>Installing &sls;</quote>
        </citetitle> (&docaddress;).
       </para>
      </formalpara>
     </listitem>
     <listitem>
      <formalpara>
       <title>A &sles4sap; installation</title>
       <para>
        To install a &slsa; system with SAP-specific customizations,
        choose
        <guimenu>Proceed with standard SLES for SAP Applications
        installation</guimenu>.
       </para>
      </formalpara>
      <itemizedlist>
       <listitem>
        <para>
         To install an SAP Application together with the system,
         activate <guimenu>Start the SAP Installation Wizard right after the OS
         installation</guimenu>.
        </para>
       </listitem>
       <listitem>
        <para>
         To prepare the system for later installation of an SAP application,
         leave <guimenu>Start the SAP Installation Wizard right after the OS
         installation</guimenu> deactivated.
        </para>
       </listitem>
      </itemizedlist>
      <para>
       Proceed with <guimenu>Next</guimenu>.
      </para>
     </listitem>
    </itemizedlist>
    <figure xml:id="fig.s4s.install.type">
     <title>Installation Type</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="s4s-install-installationtype.png" width="73%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="s4s-install-installationtype.png" width="73%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </step>
  </procedure>

  <!-- Breaking the procedure to make it more obvious that if you want to go
       through the SLES workflow, you have to stop here and read the SLES
       Installation Quick Start. Probably not ideal. - sknorr, 2016-02-11. -->

  <procedure xml:id="pro.s4s.workflow.finish">
   <title>Finishing the OS Installation</title>
   <step>
    <para>
     You can now choose whether to install an <guimenu>Add On Product</guimenu>.
     Proceed with <guimenu>Next</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Review the proposed partition setup for the volumes
     <literal>/dev/system/root</literal> and <literal>/dev/system/swap</literal>.
     The volume <literal>/dev/system/data</literal> will be created later,
     as described in <xref linkend="sec.s4s.partition"/>.
    </para>
    <para>
     Suitable values are preselected. However, if necessary, change the
     partition layout.
     You have the following options:
    </para>
    <variablelist>
     <varlistentry>
      <term><guimenu>Edit Proposal Settings</guimenu></term>
      <listitem>
       <para>
        Allows you to change the options for the proposed settings, but not the
        suggested partition layout itself.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Create Partition Setup</guimenu></term>
      <listitem>
       <para>
        Select a disk to which to apply the proposal.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Expert Partitioner</guimenu></term>
      <listitem>
       <para>
        Open the <guimenu>Expert Partitioner</guimenu> described in
        <citetitle>Deployment Guide,
         Chapter 14 <quote>Advanced Disk Setup</quote>,
         Section 14.1 <quote>Using the YaST Partitioner</quote></citetitle>
         (&docaddress;).
       </para>
       <para>
        For partitioning advice specific to &sles4sap;, see
        <xref linkend="sec.s4s.partition"/>.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <para>
     To accept the proposed setup without changes, proceed with
     <guimenu>Next</guimenu>.
    </para>
    <remark>
      Figure is maybe not ideal - it shows a hard drive with only 100GB of
      space... Fixme? - sknorr, 2016-01-20
    </remark>
    <figure xml:id="fig.s4s.install.partition">
     <title>Suggested Partitioning</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="s4s-install-partitioning.png" width="73%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="s4s-install-partitioning.png" width="73%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </step>
   <step>
    <para>
     Select the clock and time zone to use in your system. To manually adjust
     the time or to configure an NTP server for time synchronization, choose
     <guimenu>Other Settings</guimenu>.
     For detailed information, see
     <citetitle>Deployment Guide,
     Chapter 6 <quote>Installation with YaST</quote>,
     Section 6.10 <quote>Clock and Time Zone</quote></citetitle> (&docaddress;).
    </para>
    <para>
     Proceed with <guimenu>Next</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Type a password for the system administrator account (called
     <systemitem>root</systemitem>) and repeat the password under
     <guimenu>Confirm Password</guimenu>.
     You can use the text box <guimenu>Test Keyboard Layout</guimenu> to
     make sure that all special characters appear correctly.
    </para>
    <para>
     For more information, see
     <citetitle>Deployment Guide,
     Chapter 6 <quote>Installation with YaST</quote>,
     Section 6.12 <quote>Password for the System Administrator
     <systemitem class="username">root</systemitem></quote></citetitle>
     (&docaddress;).
    </para>
    <para>
     Proceed with <guimenu>Next</guimenu>.
    </para>
    <important>
     <title>Do Not Forget the <systemitem>root</systemitem> Password</title>
     <para>
      The user <systemitem class="username">root</systemitem> has the
      permission to carry out all administrative tasks. Without this password,
      you cannot log in to the system as
      <systemitem class="username">root</systemitem>.
     </para>
     <para>
      After you have entered the <systemitem class="username">root</systemitem>
      password here, it cannot be retrieved again.
     </para>
    </important>
   </step>
   <step>
    <para>
     On the screen <guimenu>Installation Settings</guimenu>, you can review
     and, if necessary, change several proposed installation settings.
     Each setting is shown alongside its current configuration.
     To change parts of the configuration, click the headline or other
     underlined items.
    </para>
    <important>
     <title>Firewall Configuration</title>
     <para>
      The software firewall of &sles4sapa; is enabled by default.
      However, often, the ports your SAP product requires to be open
      are not opened automatically.
      This means that there may be network issues until you open the required
      ports manually.
     </para>
     <para>
      For details, see <xref linkend="sec.s4s.configure.firewall"/>.
     </para>
    </important>
    <remark>
     Is there a need to copy the descriptions of all the categories from
     the Installation Quick Start here too? Or just a reference there? - sknorr,
     2016-01-12
    </remark>

    <!-- bsc#959535: When registering, High Availability pattern is selected -->
    <!-- Future FIXME: Check for SLES for SAP 12 SP2 -->
    <tip>
     <title>
      Pattern <quote>High Availability</quote> Is Necessary for High-Availability
      Installations Only
     </title>
     <para>
      If you are not planning to install a highly available SAP product, you can
      deselect the pattern <quote>High Availability</quote> from the
      installation.
      This saves space on the hard disk and download bandwidth for updates.
      Note that this pattern is distinct from the product &sleha; which you
      should not try to remove.
     </para>
     <para>
      To remove the pattern, click <guimenu>Software</guimenu> and then
      deselect <menuchoice><guimenu>Primary Functions</guimenu>
      <guimenu>High Availability</guimenu></menuchoice>.
      Return to the overview with <guimenu>OK</guimenu>.
     </para>
    </tip>

    <figure xml:id="fig.s4s.install.overview">
     <title>Installation Settings</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="s4s-install-overview.png" width="73%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="s4s-install-overview.png" width="73%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </step>
   <step>
    <para>
     When you are satisfied with the system configuration, click
     <guimenu>Install</guimenu>.
    </para>
    <para>
     Depending on your software selection, you may need to agree to further
     license agreements before you are asked to confirm that you want to start
     the installation process.
    </para>
    <warning>
     <title>Deletion of Data</title>
     <para>
      Starting the installation process means that information on the disk you
      are installing on will fully or partly be deleted.
     </para>
     <remark>
      Is this really necessary? It is not in the original installation QS...
      - sknorr, 2016-01-13
     </remark>
    </warning>
    <para>
     In the installation confirmation box, click <guimenu>Install</guimenu>.
    </para>
    <para>
     When the installation if the operating system is finished, the system
     will reboot automatically.
    </para>
    <itemizedlist>
     <listitem>
      <para>
       If you chose to only prepare the system for installation, the system will
       boot to a desktop login screen.
      </para>
     </listitem>
     <listitem>
      <para>
       If you chose to install an SAP application immediately after the
       operating system, the installation will continue after the reboot.
      </para>
      <para>
       In this case, continue with <xref linkend="cha.s4s.install.sap"/>.
      </para>
     </listitem>
    </itemizedlist>
   </step>
  </procedure>
 </sect1>

 <sect1 xml:id="sec.s4s.install.network">
  <title>Using &sles4sapa; Media from the Network</title>

  <para>
   This section provides a short description of how to install from an
   installation medium served over the network.
  </para>

  <procedure>
   <step>
    <para>
     Copy the content of the &sles4sap; DVD to a Web server (for example,
     <literal>example.com</literal>), to the directory
     <filename>/srv/www/htdocs/sap_repo</filename>.
    </para>
   </step>
   <step>
    <para>
     Boot from DVD.
    </para>
   </step>
   <step>
    <para>
     Select one of the boot menu options using the keys
     <keycap function="down"/>/<keycap function="up"/>.
     Then add to the command line. To do so, specify the parameters listed
     below:
    </para>
    <remark>
     What to do about the instmode=cd parameters that needed to be removed?
     Can I use another instmode? Parameter is not mentioned in %deploy;. fixme
     - sknorr, 2016-01-29
    </remark>
    <itemizedlist>
     <!--<listitem>
      <para>
       Remove the parameter <literal>instmode=cd</literal> from the command
       line.
      </para>
     </listitem>-->
     <listitem>
      <para>
       To start the network, add <literal>netsetup=1</literal>
      </para>
      <remark>
        Double-check if "netsetup" parameter is correct and not just legacy.
        See other remark in s4s_autoyast. - sknorr, 2016-01-28
      </remark>
     </listitem>
     <listitem>
      <para>
       Add the parameter
       <literal>autoyast=http://example.com/sap_repo/</literal>.
      </para>
     </listitem>
     <listitem>
      <para>
       Add the parameter
       <literal>install=http://example.com/sap_repo</literal>.
      </para>
     </listitem>
    </itemizedlist>
   </step>
   <step>
    <para>
     Follow the instructions in <xref linkend="sec.s4s.install.workflow"/>.
    </para>
    <remark>
     True? - sknorr, 2016-01-11
    </remark>
   </step>
  </procedure>

  <para>
   For more information, see
   <citetitle>&deploy;, Chapter 13 <quote>Remote Installation</quote></citetitle>
   (&docaddress;).
  </para>

  <para>
   To avoid having to use a DVD to bootstrap the system, you can boot over the
   network via PXE.
   For details, see <citetitle>&ay; Guide,
   Chapter 6.2.3 <quote>Booting via PXE over the Network</quote></citetitle>
   (&docaddress;).
  </para>
 </sect1>

 <xi:include href="s4s_autoyast.xml" parse="xml"/>

</chapter>
