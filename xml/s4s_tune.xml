<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="cha.s4s.tune">
 <title>Tuning</title>

 <para>
  This chapter presents information about tuning &s4sa; to work optimally with
  &sap; applications.
 </para>

 <sect1 xml:id="sec.sapconf">
  <title>Tuning Systems with the &sapconf; Profile</title>
  <para>
   The package <systemitem>sapconf</systemitem> contains the
   <systemitem>tuned</systemitem> profile <literal>sapconf</literal>.
   This single tuning profile sets recommended parameters for the following
   types of &sap; applications: &netweaver;, &hana; and &hana;-based
   applications, &ase;, and &bo;.
  </para>
  <para>
   Note that if you previously made changes to the system tuning, those
   changes may be overwritten by the &sapconf; profile.
  </para>
  <para>
   To use &sapconf;, make sure
   that the packages <package>tuned</package> and
   <package>sapconf</package> are installed on your system.
  </para>
  <note>
   <title><command>sapconf</command> Utility Is Not Included in &productname; &productnumber;</title>
   <para>
    The command-line utility <command>sapconf</command> that was included
    &productname; 11 and 12 is not available anymore in
    &productname; &productnumber;.
   </para>
  </note>
  <sect2 xml:id="sec.sapconf.enable">
   <title>Enabling and Disabling &sapconf;</title>
   <para>
    In a default &productname; installation, &tuned; is already enabled and
    the &sapconf; profile is active. To see the status of &tuned;, use:
   </para>
   <screen>&prompt.root;<command>systemctl status tuned</command></screen>
   <para>
    If &tuned; is not shown as <literal>active (enabled)</literal>, enable and
    start &tuned;:
   </para>
   <screen>&prompt.root;<command>systemctl enable --now tuned</command></screen>
   <para>
    To see which &tuned; profile is currently in use, run:
   </para>
<screen>&prompt.root;<command>tuned-adm active</command></screen>
   <para>
    If this command does not return the name of the currently active profile
    as <literal>sapconf</literal>, enable that profile:
   </para>
   <screen>&prompt.root;<command>tuned-adm profile sapconf</command></screen>
   <para>
    To disable daemon &tuned;, run:
   </para>
   <screen>&prompt.root;<command>systemctl disable tuned</command></screen>
  </sect2>
  <sect2 xml:id="sec.sapconf.configure">
   <title>Configuring &sapconf;</title>
   <para>
    You can configure &sapconf; to better fit your needs using the
    configuration file <filename>/etc/sysconfig/sapconf</filename>. This file
    contains options for the tuning parameters that are set by &sapconf;, along
    with descriptions of what the parameters do and further references.
   </para>
  </sect2>
  <sect2 xml:id="sec.sapconf.more">
   <title>For More Information</title>
   <para>
    The following man pages provide additional information about &sapconf;:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      High-level overview of tuning parameters used by &sapconf;:
      <command>man 7 tuned-profiles-sapconf</command>
     </para>
    </listitem>
    <listitem>
     <para>
      Detailed description of all tuning parameters set by &sapconf;:
      <command>man 5 sapconf</command>
     </para>
    </listitem>
    <listitem>
     <para>
      Information about configuring and customizing the &sapconf; profile:
      <command>man 7 sapconf</command>
     </para>
    </listitem>
   </itemizedlist>
  </sect2>
 </sect1>

 <sect1 xml:id="sec.saptune">
  <title>Tuning Systems with &saptune;</title>
  <para>
   Using &saptune;, you can
   tune a system for &netweaver;, &hana;/&b1;, &bo;, &ase;,
   and &s4h; applications. However, note that the generally recommended
   tuning solution for &productname; is &sapconf;, as described in
   <xref linkend="sec.sapconf"/>.
  </para>
  <para>
   To use &saptune;, make sure
   that the packages <package>tuned</package> and
   <package>saptune</package> are installed on your system.
  </para>
  <note>
   <title>&tuned; Daemon</title>
   <para>
    &sapconf; and &saptune; both rely on the daemon &tuned; to set tuning
    configuration but they use different (though very similar) tuning
    profiles. Therefore, only one of &sapconf; or &saptune; can be enabled at
    a time.
   </para>
  </note>

  <sect2 xml:id="sec.s4s.saptune.enable">
  <title>Enabling &saptune; to Tune for an &sap; Application</title>
  <procedure xml:id="pro.s4s.tune">
   <step>
    <para>
     To tune a system, first find a tuning profile.
     To find the appropriate profile, use:
    </para>
    <screen>&prompt.user;<command>saptune solution list</command></screen>
    <para>
     &saptune; knows the following
     <quote>solution</quote> profiles:
    </para>
    <itemizedlist>
     <listitem>
      <formalpara>
       <title><literal>BOBJ</literal></title>
       <para>
        Profile for servers hosting &bo;.
       </para>
      </formalpara>
     </listitem>
     <listitem>
      <formalpara>
       <title><literal>HANA</literal></title>
       <para>
        Profile for servers hosting an &hana; database.
       </para>
      </formalpara>
     </listitem>
     <listitem>
      <formalpara>
       <title><literal>MAXDB</literal></title>
       <para>
        Profile for servers hosting a MaxDB database.
       </para>
      </formalpara>
     </listitem>
     <listitem>
      <formalpara>
       <title><literal>NETWEAVER</literal></title>
       <para>
        Profile for servers hosting an &netweaver; application.
       </para>
      </formalpara>
     </listitem>
     <listitem>
      <formalpara>
       <title><literal>S4HANA-APPSERVER</literal></title>
       <para>
        Profile for servers hosting an &s4h; application.
       </para>
      </formalpara>
     </listitem>
     <listitem>
      <formalpara>
       <title><literal>S4HANA-DBSERVER</literal></title>
       <para>
        Profile for servers hosting the &hana; database of an &s4h;
        installation.
       </para>
      </formalpara>
     </listitem>
     <listitem>
      <formalpara>
       <title><literal>SAP-ASE</literal></title>
       <para>
        Profile for servers hosting an &ase; database (formerly Sybase
        Adaptive Server Enterprise).
        <!-- SAP bought Sybase in 2010, really keep "Sybase" in here? -
        sknorr, 2017-07-04 -->
       </para>
      </formalpara>
     </listitem>
    </itemizedlist>
    <para>
     Alternatively, you can tune the computer according to recommendations
     from specific &sap; Notes. A list of notes that you can tune for is
     available via:
    </para>
    <screen>&prompt.root;<command>saptune note list</command></screen>
    <para>
     The referenced &sap; Notes are available from the &sap; Web site.
     The list entries starting with <literal>SUSE-GUIDE</literal> follow the
     recommendations made in
     <link xlink:href="https://www.suse.com/communities/blog/sles-1112-os-tuning-optimisation-guide-part-1/"/>
     and
     <link xlink:href="https://www.suse.com/communities/blog/sles-1112-network-cpu-tuning-optimization-part-2/"/>.
    </para>
   </step>
   <step>
    <itemizedlist>
     <listitem>
      <para>
       To set up &saptune; with a preconfigured solution, use:
      </para>
      <screen>&prompt.root;<command>saptune solution apply <replaceable>SOLUTION</replaceable></command></screen>
     </listitem>
     <listitem>
      <para>
       To set up &saptune; for the recommendations of a specific
       &sap; Note, use:
      </para>
      <screen>&prompt.root;<command>saptune note apply <replaceable>NOTE</replaceable></command></screen>
     </listitem>
    </itemizedlist>
    <tip>
     <title>Combining Optimizations</title>
     <para>
      You can freely combine <quote>solutions</quote> and
      <quote>notes.</quote> Combining multiple optimizations will never create
      conflicts.
     </para>
    </tip>
   </step>
   <step>
    <para>
     Finally, enable the &tuned; profile
     &saptune; and make sure the
     &tuned; daemon is active:
    </para>
    <screen>&prompt.root;<command>saptune daemon start</command></screen>
   </step>
  </procedure>
  <para>
   In the background, &saptune; applies a
   &tuned; profile also named
   &saptune; that is dynamically customized according to
   selected <quote>solutions</quote> and <quote>notes</quote>.
   Using <command>tuned-adm list</command>, you can also see this profile.
  </para>
  </sect2>
  <sect2 xml:id="sec.s4s.saptune.disable">
   <title>Disabling &saptune;</title>
   <para>
    To disable &saptune;, use one of the following ways:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      Completely disable the daemon
      &tuned;:
     </para>
     <screen>&prompt.root;<command>systemctl disable tuned</command></screen>
    </listitem>
    <listitem>
     <para>
      Switch to a different
      &tuned; profile:
     </para>
     <screen>&prompt.root;<command>tuned-adm profile <replaceable>PROFILE_NAME</replaceable></command></screen>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 xml:id="sec.saptune.more">
   <title>For More Information</title>
  <para>
   See the following man pages:
  </para>
  <itemizedlist>
   <listitem>
    <para>
     <command>man 8 tuned-adm</command>
    </para>
   </listitem>
   <listitem>
    <para>
     <command>man 8 saptune</command>
    </para>
   </listitem>
  </itemizedlist>
  <para>
   Also see the project home page
   <link xlink:href="https://github.com/HouzuoGuo/saptune/"/>.
  </para>
  </sect2>
 </sect1>

 <sect1 xml:id="sec.s4s.sysctl">
  <title>Tuning Kernel Parameters Manually Using <command>sysctl</command></title>
  <para>
   In addition to or instead of tuning kernel parameters using
   &sapconf;/&saptune;, you can also use <command>sysctl</command> to
   make manual adjustments to kernel parameters. However, such changes using
   <command>sysctl</command> do not persist across reboots by default. To
   make them persist across reboots, add them to the file
   <filename>/etc/sysctl.conf</filename> (or another configuration file read
   by <command>sysctl</command>).
  </para>
  <para>
   <!-- FIXME: -> SLES docs: we don't seem to have any good section to
   reference here. Thisll do for the moment. - sknorr, 2017-05-04 -->
   For more information about <command>sysctl</command>, see the man pages
   <literal>sysctl(8)</literal>, <literal>sysctl.conf(5)</literal>, and
   <literal>sysctl.d(5)</literal>.
  </para>
 </sect1>

</chapter>
